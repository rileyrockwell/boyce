(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     15801,        494]*)
(*NotebookOutlinePosition[     16446,        516]*)
(*  CellTagsIndexPosition[     16402,        512]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["Chapter 7  -  Section 7.8", "Title",
  PageWidth->WindowWidth],

Cell[TextData[{
  "I",
  StyleBox["n this ",
    FontWeight->"Bold"],
  StyleBox["Mathematica",
    FontWeight->"Bold",
    FontSlant->"Italic"],
  StyleBox[" notebook, you find the solution to a system of three \
differential equations. The solutions to the system will be plotted \
individually as functions of ",
    FontWeight->"Bold"],
  StyleBox["t",
    FontWeight->"Bold",
    FontSlant->"Italic"],
  StyleBox[" and in three dimensional space with the corresponding direction \
field.",
    FontWeight->"Bold"],
  "\n\n",
  StyleBox["In most cases, to adapt this code to other problems, you will \
have to change only the input shown in red. To open a cell grouping, \
double-click on the right-hand side of the double cell marker.",
    FontSize->14]
}], "Subsubtitle",
  PageWidth->WindowWidth],

Cell[CellGroupData[{

Cell[TextData[{
  "Problem 12:   x' = ",
  Cell[BoxData[
      FormBox[
        RowBox[{"(", GridBox[{
              {\(-\(5\/2\)\), "1", "1"},
              {"1", \(-\(5\/2\)\), "1"},
              {"1", "1", \(-\(5\/2\)\)}
              }], ")"}], TraditionalForm]]],
  " x"
}], "Section",
  PageWidth->WindowWidth],

Cell[CellGroupData[{

Cell["\<\
Finding the Eigenvalues and Corresponding Eigenvectors for the Coefficient \
Matrix\
\>", "Subsection",
  PageWidth->WindowWidth],

Cell[TextData[{
  " We will use the ",
  StyleBox["Eigensystem",
    FontWeight->"Bold"],
  " command here as we did in the two dimensional case and express the result \
in matrix form for clarity."
}], "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{\(Clear[A]\), "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
      RowBox[{"(", GridBox[{
            {
              StyleBox[\(\(-5\)\/2\),
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]]},
            {
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox[\(\(-5\)\/2\),
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]]},
            {
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox[\(\(-5\)\/2\),
                FontColor->RGBColor[1, 0, 0]]}
            }], ")"}]}], "\[IndentingNewLine]", \(eigs = 
      Eigensystem[A]\), "\[IndentingNewLine]", \(eigs // 
      MatrixForm\)}], "Input",
  PageWidth->WindowWidth],

Cell["\<\
We see that we have real eigenvalues with one repeated. You should also \
notice that the repeated eigenvalue has two distinct eigenvectors, so the \
solution will be easy to construct. Note also that since the eigenvalues are \
negative, all solutions will approach zero as t \[Rule] \[Infinity].\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving the System of Differential Equations", "Subsection",
  PageWidth->WindowWidth],

Cell[CellGroupData[{

Cell["Using the Eigenvalues and Eigenvectors", "Subsubsection",
  PageWidth->WindowWidth],

Cell["\<\
We can call upon our eigensystem results and insert the appropriate values to \
form our general solution. You may ignore warnings about possible spelling \
errors.\
\>", "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{
    \(Clear[genlsoln, c1, c2, c3]\), "\[IndentingNewLine]", 
    \(\(soln1 = 
        eigs[\([2, 
              1]\)]\ \[ExponentialE]\^\(eigs[\([1, 1]\)]\ t\);\)\), "\
\[IndentingNewLine]", 
    \(\(soln2 = 
        eigs[\([2, 
              2]\)]\ \[ExponentialE]\^\(eigs[\([1, 2]\)]\ t\);\)\), "\
\[IndentingNewLine]", 
    \(soln3 = 
      eigs[\([2, 
            3]\)]\ \[ExponentialE]\^\(eigs[\([1, 3]\)]\ t\)\), "\
\[IndentingNewLine]", 
    \(\(genlsoln = 
        c1\ soln1\  + \ c2\ soln2 + c3\ soln3;\)\), "\[IndentingNewLine]", 
    \(genlsoln // MatrixForm\)}], "Input",
  PageWidth->WindowWidth],

Cell[TextData[{
  "You can see that because the eigenvalues are positive, all solutions, \
except ",
  Cell[BoxData[
      FormBox[
        RowBox[{"(", GridBox[{
              {"0"},
              {"0"}
              }], ")"}], TraditionalForm]]],
  " go to ",
  Cell[BoxData[
      FormBox[
        RowBox[{"(", GridBox[{
              {"\[Infinity]"},
              {"\[Infinity]"}
              }], ")"}], TraditionalForm]]],
  " as ",
  StyleBox["t",
    FontSlant->"Italic"],
  "\[Rule]\[Infinity].\nWe can solve for our arbitrary constants by inserting \
the given initial condition."
}], "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{
    RowBox[{
      RowBox[{"init1", "=", 
        StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init2", "=", 
        StyleBox["3",
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init3", "=", 
        StyleBox[\(-1\),
          FontColor->RGBColor[1, 0, 0]]}], 
      ";"}], "\[IndentingNewLine]", \(constsoln = 
      Solve[\((genlsoln /. t \[Rule] 0)\) \[Equal] {init1, init2, 
            init3}, {c1, c2, c3}]\)}], "Input"],

Cell[BoxData[
    \(partsoln = genlsoln /. constsoln\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Using the DSolve Command", "Subsubsection"],

Cell[TextData[{
  "The ",
  StyleBox["DSolve",
    FontWeight->"Bold"],
  " command is used to solve this system of three differential equations in \
the same manner used for the system of two equations. Again, we need to use \
the ",
  StyleBox["Thread",
    FontWeight->"Bold"],
  " command inside the ",
  StyleBox["DSolve",
    FontWeight->"Bold"],
  " command if we want to leave the system of equations in matrix form. Note \
that we also need the \".\" for matrix multiplication and both dependent \
variables must be called upon as functions of the independent variable, ",
  StyleBox["t",
    FontSlant->"Italic"],
  "..\nAs before, the ",
  StyleBox["ComplexExpand",
    FontWeight->"Bold"],
  " command is necessary here if we wish to see our solution in real form.\n\
We will insert a set of initial conditions at the start. You can change these \
by changing the terms in red."
}], "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{\(Clear[x1, x2, x3, t]\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"init1", "=", 
        StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init2", "=", 
        StyleBox["3",
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init3", "=", 
        StyleBox[\(-1\),
          FontColor->RGBColor[1, 0, 0]]}], 
      ";"}], "\[IndentingNewLine]", \(fastsoln = 
      DSolve[{Thread[{\(x1'\)[t], \(x2'\)[t], \(x3'\)[t]} == 
                A . {x1[t], x2[t], x3[t]}], 
            Thread[{x1[0], x2[0], x3[0]} \[Equal] {init1, init2, 
                  init3}]}, {x1[t], x2[t], x3[t]}, t] // 
        FullSimplify\)}], "Input",
  PageWidth->WindowWidth],

Cell["\<\
As before, this form appears a bit different, but it reduces to the same as \
above. Note also that the all three solutions will approach zero as t \[Rule] \
\[Infinity].\
\>", "Text",
  PageWidth->WindowWidth]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plotting Solution Trajectories as Functions of the Independent Variable\
\>", "Subsection"],

Cell["\<\
We will draw the set of solutions as functions of t. The colors red, green, \
blue, represent x1, x2, x3 respectively.\
\>", "Text"],

Cell[BoxData[
    \(\(Plot[Evaluate[partsoln[\([1]\)]], {t, 0, 10}, 
        PlotStyle \[Rule] {RGBColor[1, 0, 0], RGBColor[0, 1, 0], 
            RGBColor[0, 0, 1]}];\)\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Analyzing the Trajectory in Three Dimensional Space with the Direction \
Field\
\>", "Subsection"],

Cell["\<\
We are going to plot the three solutions together with the direction field \
for the system of differential equations. To do this, we need to load a \
graphics package.\
\>", "Text"],

Cell[BoxData[
    \(<< Graphics`PlotField3D`\)], "Input"],

Cell["\<\
The plot of this direction field uses the right hand sides of the \
differential equations as input. \
\>", "Text"],

Cell[BoxData[{\(Clear[x1, x2, x3]\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs1", "=", 
        RowBox[{
          RowBox[{
            StyleBox[\(\(-5\)/2\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x1",
              FontColor->GrayLevel[0]]}], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox["+",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x2",
              FontColor->GrayLevel[0]]}], 
          StyleBox[" ",
            FontColor->GrayLevel[0]], 
          StyleBox["+",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->GrayLevel[0]], 
            StyleBox["x3",
              FontColor->GrayLevel[0]]}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs2", "=", 
        RowBox[{
          RowBox[{
            StyleBox[\(-1\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x1",
              FontColor->GrayLevel[0]]}], 
          StyleBox["  ",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox["-",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox[\(5/2\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x2",
              FontColor->GrayLevel[0]]}], 
          StyleBox["+",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->GrayLevel[0]], 
            StyleBox["x3",
              FontColor->GrayLevel[0]]}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs3", "=", 
        RowBox[{
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x1",
              FontColor->GrayLevel[0]]}], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox["+",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x2",
              FontColor->GrayLevel[0]]}], 
          StyleBox[" ",
            FontColor->GrayLevel[0]], 
          StyleBox["-",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox[\(5/2\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->GrayLevel[0]], 
            StyleBox["x3",
              FontColor->GrayLevel[0]]}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"plotvf", "=", 
        RowBox[{"PlotVectorField3D", "[", 
          RowBox[{\({rhs1, rhs2, rhs3}\), ",", 
            RowBox[{"{", 
              RowBox[{"x1", ",", 
                StyleBox[\(-2\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"x2", ",", 
                StyleBox[\(-2\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"x3", ",", 
                StyleBox[\(-2\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], 
            ",", \(AspectRatio \[Rule] 1\), ",", \(VectorHeads \[Rule] True\),
             ",", \(ScaleFactor \[Rule]  .5\)}], "]"}]}], ";"}]}], "Input"],

Cell["\<\
When we plot the solution set, we will let t start of negative, so that you \
can see the pattern of the solution spiraling out for negative t while \
spiraling in for positive t.\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"plotsoln", "=", 
        RowBox[{"ParametricPlot3D", "[", 
          RowBox[{\(partsoln[\([1]\)]\), ",", 
            RowBox[{"{", 
              RowBox[{"t", ",", 
                StyleBox["0",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["10",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], 
            ",", \(AspectRatio \[Rule] 2\), 
            ",", \(AxesLabel \[Rule] {x1, x2, x3}\)}], "]"}]}], 
      ";"}]], "Input"],

Cell["Now, we will look at these together.", "Text"],

Cell[BoxData[
    \(\(Show[plotvf, plotsoln];\)\)], "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1024}, {0, 685}},
WindowSize->{695, 561},
WindowMargins->{{24, Automatic}, {Automatic, 30}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 68, 1, 95, "Title"],
Cell[1847, 56, 804, 23, 129, "Subsubtitle"],

Cell[CellGroupData[{
Cell[2676, 83, 317, 11, 157, "Section"],

Cell[CellGroupData[{
Cell[3018, 98, 139, 4, 56, "Subsection"],
Cell[3160, 104, 236, 7, 52, "Text"],
Cell[3399, 113, 1031, 27, 157, "Input"],
Cell[4433, 142, 321, 5, 71, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[4791, 152, 92, 1, 30, "Subsection"],

Cell[CellGroupData[{
Cell[4908, 157, 89, 1, 29, "Subsubsection"],
Cell[5000, 160, 214, 5, 52, "Text"],
Cell[5217, 167, 624, 17, 130, "Input"],
Cell[5844, 186, 629, 22, 64, "Text"],
Cell[6476, 210, 501, 13, 50, "Input"],
Cell[6980, 225, 65, 1, 30, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[7082, 231, 49, 0, 23, "Subsubsection"],
Cell[7134, 233, 928, 24, 128, "Text"],
Cell[8065, 259, 726, 17, 130, "Input"],
Cell[8794, 278, 220, 5, 52, "Text"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[9063, 289, 101, 2, 30, "Subsection"],
Cell[9167, 293, 142, 3, 33, "Text"],
Cell[9312, 298, 182, 3, 50, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[9531, 306, 108, 3, 30, "Subsection"],
Cell[9642, 311, 192, 4, 52, "Text"],
Cell[9837, 317, 57, 1, 30, "Input"],
Cell[9897, 320, 125, 3, 33, "Text"],
Cell[10025, 325, 4820, 136, 130, "Input"],
Cell[14848, 463, 203, 4, 52, "Text"],
Cell[15054, 469, 589, 15, 50, "Input"],
Cell[15646, 486, 52, 0, 33, "Text"],
Cell[15701, 488, 60, 1, 30, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

