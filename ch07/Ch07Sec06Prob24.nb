(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     11612,        354]*)
(*NotebookOutlinePosition[     12259,        376]*)
(*  CellTagsIndexPosition[     12215,        372]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["Chapter 7  -  Section 7.6", "Title",
  PageWidth->WindowWidth],

Cell[TextData[{
  "I",
  StyleBox["n this ",
    FontWeight->"Bold"],
  StyleBox["Mathematica",
    FontWeight->"Bold",
    FontSlant->"Italic"],
  StyleBox[" notebook, you find the solution to a system of three \
differential equations. The solution to the system will be plotted in three \
phase planes and also in three dimensional space with the corresponding \
direction field.",
    FontWeight->"Bold"],
  "\n\n",
  StyleBox["In most cases, to adapt this code to other problems, you will \
have to change only the input shown in red. To open a cell grouping, \
double-click on the right-hand side of the double cell marker.",
    FontSize->14]
}], "Subsubtitle",
  PageWidth->WindowWidth],

Cell[CellGroupData[{

Cell[TextData[{
  "Problem 24:   x' = ",
  Cell[BoxData[
      FormBox[
        RowBox[{"(", GridBox[{
              {\(-\(1\/4\)\), "1", "0"},
              {\(-1\), \(-\(1\/4\)\), "0"},
              {"0", "0", \(1\/10\)}
              }], ")"}], TraditionalForm]]],
  " x"
}], "Section",
  PageWidth->WindowWidth],

Cell[CellGroupData[{

Cell["\<\
Finding the Eigenvalues and Corresponding Eigenvectors for the Coefficient \
Matrix\
\>", "Subsection",
  PageWidth->WindowWidth],

Cell[TextData[{
  " We will use the ",
  StyleBox["Eigensystem",
    FontWeight->"Bold"],
  " command here as we did in the two dimensional case and express the result \
in matrix form for clarity."
}], "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{\(Clear[A]\), "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
      RowBox[{"(", GridBox[{
            {
              StyleBox[\(\(-1\)\/4\),
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["1",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["0",
                FontColor->RGBColor[1, 0, 0]]},
            {
              StyleBox[\(-1\),
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox[\(\(-1\)\/4\),
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["0",
                FontColor->RGBColor[1, 0, 0]]},
            {
              StyleBox["0",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox["0",
                FontColor->RGBColor[1, 0, 0]], 
              StyleBox[\(1\/10\),
                FontColor->RGBColor[1, 0, 0]]}
            }], ")"}]}], "\[IndentingNewLine]", \(eigs = 
      Eigensystem[A]\), "\[IndentingNewLine]", \(eigs // 
      MatrixForm\)}], "Input",
  PageWidth->WindowWidth],

Cell["\<\
We see that we have one real and two complex  eigenvalues. You should also \
notice the pattern in the eigenvectors.\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving the System of Differential Equations", "Subsection",
  PageWidth->WindowWidth],

Cell[TextData[{
  "The ",
  StyleBox["DSolve",
    FontWeight->"Bold"],
  " command is used to solve this system of three differential equations in \
the same manner used for the system of two equations. Again, we need to use \
the ",
  StyleBox["Thread",
    FontWeight->"Bold"],
  " command inside the ",
  StyleBox["DSolve",
    FontWeight->"Bold"],
  " command if we want to leave the system of equations in matrix form. Note \
that we also need the \".\" for matrix multiplication and both dependent \
variables must be called upon as functions of the independent variable, ",
  StyleBox["t",
    FontSlant->"Italic"],
  "..\nAs before, the ",
  StyleBox["ComplexExpand",
    FontWeight->"Bold"],
  " command is necessary here if we wish to see our solution in real form.\n\
We will insert a set of initial conditions at the start. You can change these \
by changing the terms in red."
}], "Text",
  PageWidth->WindowWidth],

Cell[BoxData[{\(Clear[x1, x2, x3, t]\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"init1", "=", 
        StyleBox["1",
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init2", "=", 
        StyleBox[\(-2\),
          FontColor->RGBColor[1, 0, 0]]}], ";", " ", 
      RowBox[{"init3", "=", 
        StyleBox["5",
          FontColor->RGBColor[1, 0, 0]]}], 
      ";"}], "\[IndentingNewLine]", \(fastsoln = \(DSolve[{Thread[{\(x1'\)[
                      t], \(x2'\)[t], \(x3'\)[t]} == 
                  A . {x1[t], x2[t], x3[t]}], 
              Thread[{x1[0], x2[0], x3[0]} \[Equal] {init1, init2, 
                    init3}]}, {x1[t], x2[t], x3[t]}, t] // FullSimplify\) // 
        ComplexExpand\)}], "Input",
  PageWidth->WindowWidth],

Cell["\<\
You should notice that the first two solutions will die out as t \[Rule] \
\[Infinity], but the third solution will increase without bound.\
\>", "Text",
  PageWidth->WindowWidth]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Solution Trajectories in Two Dimensions", "Subsection"],

Cell["\<\
We will draw the three phase plots corresponding to {x1,x2}, {x1,x3}, {x2,x3} \
respectively. We will anticipate the first to spiral in, but the second and \
third to spiral up the x3 axis.\
\>", "Text"],

Cell[BoxData[{
    \(\(ParametricPlot[{x1[t], x2[t]} /. fastsoln, {t, 0, 
          20}];\)\), "\[IndentingNewLine]", 
    \(\(ParametricPlot[{x1[t], x3[t]} /. fastsoln, {t, 0, 
          20}];\)\), "\[IndentingNewLine]", 
    \(\(ParametricPlot[{x2[t], x3[t]} /. fastsoln, {t, 0, 20}];\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Analyzing the Trajectory in Three Dimensional Space with the Direction \
Field\
\>", "Subsection"],

Cell["\<\
We are going to plot the three solutions together with the direction field \
for the system of differential equations. To do this, we need to load a \
graphics package.\
\>", "Text"],

Cell[BoxData[
    \(<< Graphics`PlotField3D`\)], "Input"],

Cell["\<\
The plot of this direction field uses the right hand sides of the \
differential equations as input. \
\>", "Text"],

Cell[BoxData[{\(Clear[x1, x2, x3]\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs1", "=", 
        RowBox[{
          RowBox[{
            StyleBox[\(\(-1\)/4\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x1",
              FontColor->GrayLevel[0]]}], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox["+",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox["1",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x2",
              FontColor->GrayLevel[0]]}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs2", "=", 
        RowBox[{
          RowBox[{
            StyleBox[\(-1\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x1",
              FontColor->GrayLevel[0]]}], 
          StyleBox["  ",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox["-",
            FontColor->RGBColor[1, 0, 0]], 
          StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], 
          RowBox[{
            StyleBox[\(1/4\),
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
            StyleBox["x2",
              FontColor->GrayLevel[0]]}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rhs3", "=", 
        RowBox[{
          StyleBox[\(1/10\),
            FontColor->RGBColor[1, 0, 0]], " ", "x3"}]}], 
      ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"plotvf", "=", 
        RowBox[{"PlotVectorField3D", "[", 
          RowBox[{\({rhs1, rhs2, rhs3}\), ",", 
            RowBox[{"{", 
              RowBox[{"x1", ",", 
                StyleBox[\(-2\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"x2", ",", 
                StyleBox[\(-2\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"x3", ",", 
                StyleBox["0",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["20",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], 
            ",", \(AspectRatio \[Rule] 1\), 
            ",", \(VectorHeads \[Rule] True\)}], "]"}]}], ";"}]}], "Input"],

Cell["\<\
When we plot the solution set, we will let t start of negative, so that you \
can see the pattern of the solution spiraling out for negative t while \
spiraling in for positive t.\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"plotsoln", "=", 
        RowBox[{"ParametricPlot3D", "[", 
          RowBox[{\(Evaluate[{x1[t], x2[t], x3[t]} /. fastsoln]\), ",", 
            RowBox[{"{", 
              RowBox[{"t", ",", 
                StyleBox[\(-1\),
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox[",",
                  FontColor->RGBColor[1, 0, 0]], 
                StyleBox["15",
                  FontColor->RGBColor[1, 0, 0]]}], "}"}], 
            ",", \(AspectRatio \[Rule] 2\), 
            ",", \(AxesLabel \[Rule] {x1, x2, x3}\)}], "]"}]}], 
      ";"}]], "Input"],

Cell["Now, we will look at these together.", "Text"],

Cell[BoxData[
    \(\(Show[plotvf, plotsoln];\)\)], "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1024}, {0, 685}},
WindowSize->{857, 527},
WindowMargins->{{26, Automatic}, {-106, Automatic}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 68, 1, 95, "Title"],
Cell[1847, 56, 694, 18, 129, "Subsubtitle"],

Cell[CellGroupData[{
Cell[2566, 78, 316, 11, 157, "Section"],

Cell[CellGroupData[{
Cell[2907, 93, 139, 4, 38, "Subsection"],
Cell[3049, 99, 236, 7, 33, "Text"],
Cell[3288, 108, 1030, 27, 157, "Input"],
Cell[4321, 137, 140, 3, 33, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[4498, 145, 92, 1, 30, "Subsection"],
Cell[4593, 148, 928, 24, 109, "Text"],
Cell[5524, 174, 769, 17, 130, "Input"],
Cell[6296, 193, 189, 4, 33, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[6522, 202, 70, 0, 30, "Subsection"],
Cell[6595, 204, 213, 4, 52, "Text"],
Cell[6811, 210, 302, 5, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[7150, 220, 108, 3, 30, "Subsection"],
Cell[7261, 225, 192, 4, 52, "Text"],
Cell[7456, 231, 57, 1, 30, "Input"],
Cell[7516, 234, 125, 3, 33, "Text"],
Cell[7644, 239, 2983, 82, 130, "Input"],
Cell[10630, 323, 203, 4, 52, "Text"],
Cell[10836, 329, 618, 15, 50, "Input"],
Cell[11457, 346, 52, 0, 33, "Text"],
Cell[11512, 348, 60, 1, 30, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

